{"version":3,"sources":["webpack:///./src/views/singer.vue?ab3e","webpack:///src/views/singer.vue","webpack:///./src/views/singer.vue?fc10","webpack:///./src/views/singer.vue","webpack:///./src/views/singer.vue?a09c"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","_l","value","index","key","refInFor","_v","_s","requset","id","on","$event","switchSinger","directives","name","rawName","expression","attrs","class","currentindex","stopPropagation","touchstar","touchmove","firsttitle","staticRenderFns","data","letter","iscroll","starpage","movepage","iscrollpath","firsttitleY","computed","components","Scrollview","methods","keydwn","offsetY","$refs","scrollview","scrollTo","setoffY","e","touches","pageY","parseInt","target","dataset","currpage","$router","push","watch","$nextTick","created","mounted","scrolling","component"],"mappings":"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","file":"js/chunk-de863e3a.53d5f587.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"singer\"},[_c('Scrollview',{ref:\"scrollview\"},[_c('ul',_vm._l((_vm.letter),function(value,index){return _c('li',{key:index,ref:\"iscroll\",refInFor:true,staticClass:\"letter\"},[_c('h2',[_vm._v(_vm._s(value))]),_c('ul',{staticClass:\"singers\"},_vm._l((_vm.requset[index]),function(value){return _c('li',{key:value.id,on:{\"click\":function($event){return _vm.switchSinger(value.id)}}},[_c('div',{staticClass:\"imgru\"},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(value.picUrl),expression:\"value.picUrl\"}],attrs:{\"alt\":\"\",\"srcset\":\"\"}})]),_c('span',[_vm._v(_vm._s(value.name))])])}),0)])}),0)]),_c('ul',{staticClass:\"nav\"},_vm._l((_vm.letter),function(value,index){return _c('li',{key:index,class:{'active':_vm.currentindex == index},attrs:{\"data-index\":index},on:{\"touchstart\":function($event){$event.stopPropagation();return _vm.touchstar($event)},\"touchmove\":function($event){$event.stopPropagation();return _vm.touchmove($event)}}},[_vm._v(\" \"+_vm._s(value)+\" \")])}),0),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.firsttitle!== ''),expression:\"firsttitle!== ''\"}],ref:\"firsttitle\",staticClass:\"top-nav\"},[_vm._v(_vm._s(_vm.firsttitle))]),_c('transition',[_c('router-view')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div class=\"singer\">\r\n<Scrollview ref=\"scrollview\">\r\n    <ul>\r\n      <li class=\"letter\" ref=\"iscroll\" v-for=\"(value,index) in letter\" :key=\"index\">\r\n        <h2 >{{value}}</h2>\r\n        <ul class=\"singers\">\r\n          <li v-for=\"(value) in requset[index] \" :key=\"value.id\" @click=\"switchSinger(value.id)\">\r\n            <div class=\"imgru\">\r\n            <img v-lazy=\"value.picUrl\" alt=\"\" srcset=\"\">\r\n            </div>\r\n            <span>{{value.name}}</span>\r\n          </li>\r\n        </ul>\r\n      </li>\r\n    </ul>\r\n</Scrollview>\r\n  <ul class=\"nav\">\r\n    <li v-for=\"(value,index) in letter\" \r\n    @touchstart.stop = \"touchstar\"\r\n    @touchmove.stop = \"touchmove\"\r\n    :data-index = index \r\n\r\n    :class=\"{'active':currentindex == index}\" :key=\"index\">\r\n      {{value}}\r\n    </li>\r\n  </ul>\r\n  <div v-show=\"firsttitle!== ''\" class=\"top-nav\" ref=\"firsttitle\">{{firsttitle}}</div>\r\n       <transition>\r\n       <router-view></router-view>\r\n     </transition>\r\n</div>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\nimport {getLetterSinger,getallLetter} from '../api/index'\r\nimport Scrollview from '../components/scrollview'\r\nexport default {\r\n  name: 'singer',\r\n  data:function(){\r\n    return{\r\n      letter:[],\r\n      requset:[],\r\n      iscroll:[],\r\n      currentindex:0,\r\n      starpage:0,\r\n      movepage:0,\r\n      iscrollpath:0,\r\n      firsttitleY:85\r\n    }\r\n  },\r\n  computed:{\r\n      firsttitle(){\r\n      if(this.currentindex <= 0 ){\r\n        return ''\r\n      }else{\r\n        return this.letter[this.currentindex]\r\n      }\r\n    }\r\n  },\r\n  components:{\r\n    Scrollview\r\n  },\r\n  methods:{\r\n    keydwn(index){\r\n      this.currentindex = index \r\n      // console.log(this.currentindex)\r\n      var offsetY = this.iscroll[index]\r\n      // console.log(-offsetY)\r\n      this.$refs.scrollview.scrollTo(0,-offsetY)\r\n    },\r\n    touchstar(e){\r\n      let setoffY =  e.target.dataset.index \r\n      this.keydwn(setoffY)\r\n      this.starpage = e.touches[0].pageY\r\n    },\r\n    touchmove(e){\r\n      this.movepage = e.touches[0].pageY\r\n      //计算移动的距离 用移动的距离除以元素的宽高得出index\r\n      let currpage = Math.floor((this.movepage - this.starpage) / e.target.offsetHeight)\r\n      //当前按下的index 加上移动的index\r\n      var index = parseInt(e.target.dataset.index)  + currpage\r\n      if(index<0){\r\n        currpage = 0\r\n      }\r\n      this.keydwn(index)\r\n\r\n    },\r\n    switchSinger(id){\r\n      this.$router.push({path:`/singer/detail/${id}/singer`})\r\n\r\n    }\r\n    \r\n  },\r\n  watch:{\r\n    requset(nv){\r\n      //$nextTick回调在元素加载后执行\r\n      //计算每一个元素距离上边的距离\r\n      this.$nextTick(()=>{\r\n        this.$refs.iscroll.forEach((value)=>{\r\n          this.iscroll.push(value.offsetTop)\r\n        })\r\n      })\r\n    },\r\n    firsttitle(){\r\n       this.$nextTick(()=>{\r\n       this.firsttitleY = this.$refs.firsttitle.offsetHeight\r\n      })\r\n    }\r\n\r\n\r\n  },\r\n  created(){\r\n    // console.log('创建')\r\n    getallLetter()\r\n    .then((data)=>{\r\n      this.letter =data.letter\r\n      this.requset = data.data\r\n      // console.log(data)\r\n    })\r\n    \r\n  },\r\n  mounted(){\r\n    //滚动到哪一个区域 导航选中哪一个区域\r\n    this.$refs.scrollview.scrolling((y)=>{\r\n      this.iscrollpath = y\r\n      // console.log(this.iscrollpath)\r\n    // 第一个区域\r\n      if(y >=0){\r\n        this.currentindex = 0\r\n        return\r\n      }\r\n      //中间区域 如果滚动距离大于 这个区域并且小于下一个区域 则是当前区域\r\n      for (let i = 0; i < this.iscroll.length -1; i++) {\r\n          let firstpathY = this.iscroll[i] \r\n          let lastpathY = this.iscroll[i+1]\r\n          let currentoffsetpath = 0   \r\n          //计算推动动画 滚动距离加上下一组的宽高     \r\n          let switchY =  y+ lastpathY\r\n          if(switchY >0 &&switchY < this.firsttitleY){\r\n            currentoffsetpath = switchY - this.firsttitleY\r\n            // console.log(currentoffsetpath)\r\n          }else{\r\n            currentoffsetpath = 0\r\n          }\r\n          // console.log(currentoffsetpath)\r\n          // this.$refs.firsttitle.style.transform = `translateY(${currentoffsetpath}px)`\r\n          // console.log(this.$refs.firsttitle.style.transform)\r\n\r\n          if(-y >= firstpathY && -y<= lastpathY){\r\n            this.currentindex = i \r\n            // console.log(firstpathY,lastpathY)\r\n            return\r\n          }\r\n            this.currentindex = this.iscroll.length-1\r\n          \r\n      }\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style lang=\"scss\" scoped>\r\n.singer{\r\n  position: fixed;\r\n  overflow: hidden;\r\n  top: 180px;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  transform: translateY();\r\n  .nav{\r\n    position: fixed;\r\n    right: 0;\r\n    top: 220px;\r\n    li{\r\n      padding: 5px 0;\r\n      text-align: center;\r\n      &.active{\r\n        text-shadow: 0 0 10px #000;\r\n      }\r\n\r\n    }\r\n   \r\n  }\r\n  .letter{\r\n    \r\n    h2{\r\n      background:  red;\r\n      padding: 10px 20px;\r\n      color: #fff;\r\n    }\r\n    \r\n  }\r\n  .singers {\r\n  \r\n    li{\r\n    display: flex;\r\n    height: 220px;\r\n    align-items: center;\r\n    .imgru{\r\n        margin-left: 5%;\r\n        width: 120px;\r\n        height: 120px;\r\n        border-radius: 50%;\r\n        overflow: hidden;\r\n        img{\r\n          width: 100%;\r\n          height: 100%;\r\n        }\r\n      }\r\n      span{\r\n        margin-left: 5%;\r\n        display: flex;\r\n        font-size: 32px;\r\n      }\r\n    }\r\n  }\r\n   .top-nav{\r\n    position: fixed;\r\n    overflow: hidden;\r\n    top: 180px;\r\n    left: 0;\r\n    right: 0;\r\n    background:  red;\r\n    padding: 10px 20px;\r\n    color: #fff;\r\n    }\r\n}\r\n\r\n.v-enter{\r\n  transform: translateX(100%);\r\n}\r\n.v-enter-to{\r\n  transform: translateX(0%);\r\n}\r\n.v-enter-active{\r\n  transition: transform 1s;\r\n}\r\n\r\n.v-leave{\r\n  transform: translateX(0%);\r\n}\r\n.v-leave-to{\r\n  transform: translateX(100%);\r\n}\r\n.v-leave-active{\r\n  transition: transform 1s;\r\n}\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./singer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./singer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./singer.vue?vue&type=template&id=a2555484&scoped=true&\"\nimport script from \"./singer.vue?vue&type=script&lang=js&\"\nexport * from \"./singer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./singer.vue?vue&type=style&index=0&id=a2555484&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a2555484\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./singer.vue?vue&type=style&index=0&id=a2555484&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./singer.vue?vue&type=style&index=0&id=a2555484&lang=scss&scoped=true&\""],"sourceRoot":""}